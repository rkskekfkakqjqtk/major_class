# 데이터베이스 설계 단계

## 설계
**사용자들의 요구 사항을 고려해 데이터 베이스를 생성**

**품질 좋은 데이터베이스 생성 조건**
- 데이터의 일관성, 무결성 유지
- 사용자가 이해하기 쉽고 접근하기 편해야함
- 구성원들의 요구 사항 만족성 여부

## 설계의 2가지 방법

1. **E-R 모델과 릴레이션 변환 규칙을 이용한 설계**

2. **정규화를 이용한 DB 설계**

## E-R 모델, 릴레이션 변환 규칙

**1단계: 요구분석**
- 구성원들의 사용 용도 파악
- 필요한 데이터의 종류와 처리 방법에 대한 요구 사항 수집 -> 요구 사항 명세서 작성
- ==DB의 용도 파악 -> 요구 사항 명세서==

**2단계: 개념적 설계**
- DBMS에 독립적인 개념적 주고 설계
- **개념적 모델**: 요구 사항 명세서를 개념적 데이터 모델로 변환
- E-R 모델은 데이터 요소와 요소간의 관계를 E-R 다이어그램으로 표현
- ==DBMS에 독립적인 개념적 구조 설계 -> 개념적 스키마(E-R 다이어그램)==

**3단계: 논리적 설계**
- 개념적 설계를 기반으로 DBMS에 논리적 구조 설계
- **논리적 모델링**: E-R 다이어그램을 릴레이션 스키마로 변환
- ==DBMS에 적합한 논리적 구조 설계 -> 논리적 스키마(릴레이션 스키마)==

**4단계: 물리적 설계**
- 논리적 구조를 기반으로 물리적 구조 설계
- **물리적 구조**: 내부 저장 구조, 접근 경로 등을 의미
- 저장 레코드, 인덱스의 구조 등을 설계, 저장된 데이터와 인덱스를 빠르게 접근하는 방법 정의
- ==DBMS로 구현 가능한 물리적 구조 설계 -> 물리적 스키마==

**5단계: 구현**
- 데이터 정의어 "DDL"을 이용해 DB를 실제로 생성
- ==SQL문을 작성후 DBMS에서 실행해 DB생성==
***
# 요구 사항 분석

**DB에 대한 사용자들의 요구사항 수집 및 분석**
- 요구 사항 명세서로 작성
	- DBA가 양식을 만들어 배포
	- 만약 기존 시스템을 대체할 신규 시스템이라면, 기존 시스템 + 신규 요구 사항을 같이 정리
***
# 개념적 설계

**요구 사항으로부터 개체와 개체 간의 관계 분석**
- E-R 다이어그램으로 작성

**E-R 모델을 이용한 개념적 모델링 과정**
- 개체, 주요 속성, 키 속성 선별
- 개체 간의 관계 결정
- E-R 다이어그램으로 최종 표현

## 개체와 속성 추출

**요구 사항 명세서로 부터 개체 찾기**
- 개체, 관계 구분 어려움
- 개체는 대체적으로 요구사항 내에서 **명사**를 찾아야함
- 명사가 여러개면 **대표 명사** 하나만 선택 (나머지는 개체의 속성이 될 수 있음)
- 조직 자체를 가리키는 것은 배제
- 명사라고 생각하는 것도 명사가 아닐 수 있음
- 찾아낸 명사들에서 개체와 속성 가려야함

**찾은 명사들로부터 개체와 속성 분류** ex)
- ![[Pasted image 20240416082337.png|]]
	- 한빛 마트는 DBMS로부터 서비스하는 주체라 빠져도 됨
	- 회원을 개체로 추출
- ![[Pasted image 20240416082410.png]]
	- 상품을 추가적으로 개체로 추출
	- But, 주문번호, 주문수량, 배송지, 주문일자는 회원과 상품 개체에 속할 수 없음
- ![[Pasted image 20240416082536.png]]
	- 최종적으로 개체와 속성매치
	- 주문번호, 공급일자 등의 명사는 제외

**E-R 다이어그램 작성**
- ![[Pasted image 20240416132000.png]]

## 관계 추출

**요구 사항 명세서로부터 관계 찾기**
- 관계는 대체적으로 요구사항 내에서 **동사**를 찾아야 한다
- 동사가 여러개면 **대표 동사** 하나만 선택해야 함
- **매핑 카디널리티**: 일대일, 일대다, 다대다
- 관계가 필수적 (이중 실선)인지 선택적 (실선)인지 참여 특성을 결정

**EX)
- 입력 해야한다, 부여된다, 식별한다는 단순히 개체를 **설명**하는것으로 제외
- 주문: 회원과 상품 개체의 관계
- 유지해야 한다는 단순히 속성을 설명하므로 제외
- 공급: 상품과 제조업체 개체의 관계
- 유지는 똑같이 제외
- 작성: 회원과 게시글 개체의 관계

**최종적으로 대체 간의 관계 선별**
- 입력해야 한다, 부여된다, 유지해야 된다 등의 동사는 제외
- 주문: 회원(n) 과 상품(m) 개체의 연관성 표현, 주문 속성을 가짐
- ![[Pasted image 20240418121432.png|500]]
- 공급: 상품(n)과 제조업체(1) 개체의 연관성 표현, 공급 속성을 가짐
- 상품 개체가 공금 관계에 필수적으로 참여하고 있음을 표현
- ![[Pasted image 20240418121522.png]]
- 작성: 게시글(n)과 회원(1) 개체의 연관성 표현, 작성 속성은 없음
- 게시글 개체가 작성 관계에 필수적으로 참여함을 표현
- ![[Pasted image 20240418121642.png|500]]

## E-R 다이어그램 작성
- 4개의 객체와 3개의 관계 표현![[Pasted image 20240418121744.png|500]]
***
# 논리적 설계
## E-R 다이어그램 -> 릴레이션 스키마

**관계 데이터 모델 (릴레이션 스키마) 기준에서 둘간의 차이점**![[Pasted image 20240418122055.png]]
## 릴레이션 스키마 규칙
- 규칙 1: 모든 개체는 릴레이션으로 변환한다
- 규칙 2: 다대다 관계는 릴레이션으로 변환한다
- 규칙 3: 일대다 관계는 외래키로 표현한다
- 규칙 4: 일대일 관계는 외래키로 표현한다
- 규칙 5: 다중 값 속성은 릴레이션으로 변환한다
- 기타 고려 사항

**규칙 1**: 모든 개체는 릴레이션으로 변환
- 복합 속성인 주소는 단순 속성(우편번호, 기본주소, 상세주소)만 고객 릴레이션에 포함
- 고객(고객번호, 이름, 등급, 우편번호, 기본주소, 상세주소)![[Pasted image 20240418122423.png|500]]

**규칙 2**: 다대다 관계는 릴레이션으로 표현
- 주문(주문번호, 고객번호, 상품번호, 주문수량) > 주문(고객번호, 상품번호, 주문수량)![[Pasted image 20240418122533.png|500]]

**규칙 3**: 일대다 관계는 외래키로 표현
- **규칙 3-1**: 일반적 일대다 관계는 외래키로 표현
- 상품(상품번호, 상품명, 재고량, 단가, 제조업체명, 공급수량)![[Pasted image 20240418122644.png|500]]
- **규칙 3-2**: 약한 개체가 참여하는 일대다 관계는 외래키를 포함해 기본키로 지정
- 좌석(비행기번호, 좌석번호, 좌석등급, 이용금액)![[Pasted image 20240418122736.png|500]]

**규칙 4**: 1대1 관계는 외래키로 표현
- **규칙 4-1**: 일반적 일대일 관계는 외래키를 주고 받음
- 서로의 기본 외래키를 받아 릴레이션의 속성으로 포함
- ![[Pasted image 20240418112902.png|500]]
- **규칙 4-2**: 일대일 관계에 필수로 참여하는 개체의 릴레이션만 외래키 받음
- 남자는 결혼을 꼭 해야하고 여자는 하지 않아도 되는 구조
- ![[Pasted image 20240418113104.png|500]]
- **규칙 4-3**: 모든 개체가 일대일관계에 필수로 참여시 릴레이션은 하나로
- 남자,여자 모두 결혼해야하는 구조
- ![[Pasted image 20240418113215.png|500]]

**규칙 5**: 다중 값 속성은 릴레이션으로 변환
- 다중 값을 가지는 속성은 없기 때문에 아래 릴레이션퍼럼 표현 또는 사원-부하직원 릴레이션으로 분리
- ![[Pasted image 20240418120438.png]]
- 반드시 별도의 릴레이션으로 분리할 필요는 없음

## 기타 고려 사항

**속성이 많은 관계는 유형 상관없이 릴레이션으로 변환 가능**
- 다대다 관계가 아닐 경우 불필요한 릴레이션 개수가 많아져 DBMS에 부담
- ![[Pasted image 20240418120622.png|500]]
- 일대다 관계일때 순환 관계의 속성으로 릴레이션 포함 가능
- ![[Pasted image 20240418120733.png|500]]
## 릴레이션 스키마 변환 규칙으로 논리적 설계

**한빛 마트 E-R 다이어그램에 규칙 1 적용**
![[Pasted image 20240418120921.png]]

**규칙 2 적용**
![[Pasted image 20240418121002.png]]

**규칙 3 적용**
![[Pasted image 20240418121022.png]]

**테이블 명세서 작성**
- **테이블 명세서**: 릴레이션 스키마에 대한 설계 정보를 기술한 문서
- MS SQL 서버를 DBMS로 사용시
- ![[Pasted image 20240418121121.png|500]]
***
# 물리적 설계와 구현

## DB설계

**테이블 명세서를 통해 SQL문 작성**
- DBMS의 GUI를 통해 빌드 or 직접 SQL문 작성
- 모든 테이블 정의서의 릴레이션 빌드가 완료되면 일반적으로 DB 빌드 스크립트는 백업
- ![[Pasted image 20240418121319.png|500]]
- 