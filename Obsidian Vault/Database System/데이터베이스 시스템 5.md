# 관계 데이터 모델의 기본 용어
- 릴레이션: 개체와 관계를 표로 표현함. 파일 관리 시스템의 파일
- 속성: 릴레이션의 열, 파일의 필드에 대응하는 개념
- 튜플: 릴레이션의 행 혹은 고객 개체 인스턴스
- 도메인: 속성이 가질 수 있는 모든 값의 집합
![[Pasted image 20240327225318.png]]

### 도메인
- {vip, gold, silver, bronze} 라면
- 등급 속성의 도메인이 됨
- DBMS는 이 4가지 이외의 값은 허용하지 않음으로써 올바른 값을 유지할 수 있음
- 또한 동일한 데이터 타입이 아니면 비교 연산을 할 수 없음(나이 vs 이름)

### 널 값 null
- 특정 튜플 값을 모르거나, 적합한 값이 없는 경우
- 0과 공백 문자와는 다름
- DBMS 마다 널 값의 표기 방식이 다를 수 있음

### 차수
- 속성의 전체 개수: 6개

### 카다널리티
- 튜플 전체 개수, 값이 삽입/삭제 등으로 자주 변하는 특성을 가지고 있음
![[Pasted image 20240327225646.png]]

### 릴레이션 스키마와 인스턴스
![[Pasted image 20240327225703.png]]

### 릴레이션 스키마
##### 표현방법
- 릴레이션 이름(속성 이름1, 속성 이름2, ...)
- 고객(고객아이디, 고객이름, 나이, 등급, 직업, 적립금)
##### 릴레이션 인스턴스
- 릴레이션에 존재하는 튜플의 집합
- 고객 릴레이션에는 4개의 튜플로 구성됨
- 데이터 조작어를 이용해 튜플의 추가, 삭제 및 수정이 가능하므로 동적인 특성을 가짐

### 데이터베이스 스키마 설계
- 모든 릴레이션 스키마를 정의하는 것
- 데이터베이스를 구성하는 모든 릴레이션의 인스턴스를 모아 놓은 것
![[Pasted image 20240327225841.png|600]]

### 릴레이션의 특징
##### 튜플의 유일성: 하나의 릴레이션에는 동일한 튜플이 존재할 수 없다
- 인터넷 쇼핑몰 가입 시 다른 고객 아이디와 중복되어 아이디를 변경하는 경험
- 키: 튜플을 유일하게 구별하기 위해 선정하는 속성 혹은 여러 속성들
##### 튜플의 무순서: 하나의 릴레이션에는 튜플 사이의 순서는 무의미 하다.
- 튜플의 순서가 바뀌더라도 다른 릴레이션이 될 수 없음
- 튜플은 삽입 순서에 따라 저장되지만 DB 변경이 없는 릴레이션의 경우(Ex. 시설)는 저장 시 순서를 지정하기도 함
- 속성은 위치가 아닌 속성의 이름으로 접근하기 때문에 중복되어 존재할 수 없음 
- 속성의 의미가 명확한 것을 사용해야 함
##### 튜플의 원자성: 속성 값으로 원자 값만 사용할 수 있다
- 모든 속성 값은 더 분해할 수 없는 하나의 값만 가짐
- 다중 값을 허용하지 않음 ![[Pasted image 20240327230130.png|600]]

### 키의 종류
- 관계 데이터 모델에서 5가지로 분류할 수 있음
![[Pasted image 20240327230152.png|500]]

### 슈퍼키
- 유일성의 특징을 만족하는 속성 또는 속성들의 집합
- 슈퍼키를 포함한 속성 집합도 슈퍼키가 될 수 있음
- Ex. 고객아이디 + 고객 이름
### 후보키
- 유일성과 최소성을 만족하는 속성 또는 속성들의 집합
- 고객아이디 + 고객이름은 후보키가 될 수 없음 // 슈퍼키 중 최소성을 만족하지 못함
- Ex. 고객 이름은 중복성이 있을 수 있으므로 후보키로 선택하는 것이 부적절함
### 기본키
- 데이터베이스 설계자는 여러 후보키 중에서 기본키를 반드시 선택해야 함
- 만약 후보키가 여러 개라고 한다면 데이터베이스 사용 환경을 고려하여 적합한 것을 선택함
- 기본키는 밑줄로 표현할 수 있음
- 주소 속성이 추가 된다면 기본키가 될 수 있을까? -----> 되기 어려움
![[Pasted image 20240327230436.png]]

### 기본키 선택 시 고려사항
- 널 값을 가질 수 있는 속성이 포함된 후보키는 부적절함
	- 널 값을 가진 튜플은 다른 튜플들과 구별하여 접근하기 어려움
	- 고객 주소는 입력하지 않아도 되는 경우가 있음
- 값이 자주 변경될 수 있는 속성이 포함된 후보키는 부적절함
	- 값이 자주 변경되는 후보키는 변경할 때마다 기본키 값으로 적합한지 여부를 판단해야 함
	- 고객이름은 자주 변경되지는 않으나 주소는 변경될 가능성이 있음
- 단순한 후보키를 기본키로 선택함
	- 자리수가 적은 정수나 단순 문자열인 속성으로 구성되거나 구성하는 속성의 개수가 적은 것이 적절함
	- 고객아이디 > 고객이름

### 대체키
- 기본키로 선택되지 못한 후보키
- 대체키 고객이름 정도가 될 수 있음
![[Pasted image 20240327230639.png]]

### 외래키
- 어떤 릴레이션에 소속된 속성 또는 속성 집합이 다른 릴레이션의 기본키가 되는 키
- 다른 릴레이션의 기본키를 그대로 참조하는 속성의 집합
- 주문 고객이 키가 되어 고객 & 주문 릴레이션의 모든 속성 조회가 가능함
![[Pasted image 20240327230720.png|600]]
### 외래키 참조 방법
- 반드시 고객 릴레이션의 기본키를 참조해야 함
- 릴레이션의 속성은 다르게 정의되어도 도메인(데이터 타입)은 동일하게 정의 되어야 함
![[Pasted image 20240327230757.png]]
- 학생 상담을 위한 데이터베이스를 설계한다고 할 때
	- 기본키: 학생 릴레이션의 학번, 교사 릴레이의 교사번호
	- 외래키: 상담 릴레이션의 학번과 담당사
	- ![[Pasted image 20240327230839.png|400]]
### 외래키 참조의 다른 예 (자기 릴레이션을 참조할 때)
- Recursive 구조
- Ex. 조직도 구조(팀 → 부서장 → 본부장 (연구소장) → CEO (원장))
- 최상위의 추천 고객은 아래 고객이름 중 무엇일까? -----> 정지영
- 고객 아이디는 Not Null 이지만, 추천 고객은 Null 일 수 있음
![[Pasted image 20240327231016.png]]


# 무결성 제약조건

### 무결성
- 데이터가 정확하고 유효하게 유지된 상태
### 무결성 제약조건의 목적
- DB에 저장된 데이터의 무결성을 보장하고 DB 상태를 일관되게 유지하는 것
- 무결성 제약조건 종류
![[Pasted image 20240327231109.png]]

### 개체 무결성 제약조건
- 기본키를 구성하는 모든 속성은 Null 값을 가지면 안된다
	- 기본키가 널 값을 가지게 되면 본래의 목적(튜플을 유일하게 구별함)을 상실함
	- 기본키에 널 값이 포함되는 것을 거부하면 됨(혹은 자동으로 고객아이디 생성하게 함)
![[Pasted image 20240327231203.png]]

### 참조 무결성 제약조건
- 외래키는 참조할 수 없는 값을 가질 수 없다
	- 외래키는 기본키의 값을 가져야 하는데, 기본키에 없는 값을 가지면 참조가 불가능 함
	- cherry는 고객 릴레이션에 먼저 값이 입력되지 않는 이상 주문 릴레이션에 존재할 수 없음
![[Pasted image 20240327231252.png]]
- 외래키는 Null 값을 가질 수 있나? ----->가능하다
	- 참조 무결성 제약조건을 위반하는 것은 아님
	- 하지만, 개체 무결성 제약조건을 위반하지 않도록 Null 값을 아닌 고객아이디를 넣어 줘야함
![[Pasted image 20240327231352.png]]
- 만약 고객 릴레이션 김현준 튜플을 삭제한다면?
	- 주문 릴레이션에 존재하는 데이터로 에러가 나야하며 삭제되어서는 안됨
	- 주문 릴레이션에서 apple을 Null 값 처리하면 고객 릴레이션에서 김현준 고객을 지울 수는 있음
	- 하지만 무결성 제약 조건으로 고객/주문 릴레이션의 김현준 튜플 정보를 한꺼번에 삭제해야 함
![[Pasted image 20240327231448.png]]
- 만약 고객릴레이션의 김현준의 고객아이디가 grape로 변경된다면?
	- 주문 릴레이션의 외래키(주문고객)을 Null 값 처리 후 고객 릴레이션의 고객아이디를 grape로 변경하고 주문 릴레이션의 외래키(주문고객)을 Null 값에서 grape로 변경함
	- 일반적으로는 릴레이션에 속성을 기준으로 기본키를 대체할 다른 속성들로 조합된 키를 갖기 때문에 외래키가 Null 값이어도 찾아서 업데이트 될 수 있게 함
	- 그렇지 않다면 기본키 변경을 제한하거나 DBMS에서 일괄적으로 변경해줘야 함

