### 프로토콜의 기초
멀티 드롭<sup>Multi-Drop</sup>방식
- 하나의 호스트가 다수의 호스트와 연결된 비대칭 형태의 구조
	- 점대점 방식: 라우팅 과정 불필요
	- 호스트를 구분하기 위한 주소 개념이 필요함
- 데이터 링크 L2 계층의 기본 역할
	- 물리적 전송 오류 발생시 오류 복구가 필요함
	- 재전송: 송신 호스트가 전송 데이터를 다시 보냄
![[6장. 데이터 링크 계층-20240419130039068.webp|300]]
### 프레임의 종류
##### 정보 프레임, I 프레임
- 상위 계층이 전송을요구한 데이터를 수신 호스트에 전송하는 용도로 사용함
- 구성: 상위 계층에서 보낸 데이터, 프레임의 순서 번호, 송수신 호스트 주소, 오류 검출 코드 등
##### 긍정 응답 프레임, ACK 프레임
- 프레임 변형 오류가 발생하지 않으면 송신 호스트에 해당 프레임을 올바르게 수신했다는 의미로 전달함
- 해당 정보 프레임의 전송을 완료함
##### 부정 응답 프레임, NACK 프레임
- 프레임의 변형 오류가 발생하면 송신 호스트에 해당 프레임을 올바르게 수신하지 않았다는 의미로 전달함
- 송신 호스트가 오류 발생을 인지하여 정보 프레임을 **재전송**하도록 요청하는 것
---
순서 번호는 I 프레임에만 있을까?
- ACK/JNACK 프레임의 순서 번호 확인을 통해 오류 발생 유무를 확인할 수 있음
만약 프레임 분실 오류가 발생한다면
- 송신 호스트의 타임아웃 기능을 통해 프레임을 재전송
---
##### 단방향 프로토콜
흐름 제어와 오류 제어가 필요 없는 전송 환경 (이상적인 전송 환경)
- 단방향 통신: 송신 호스트 → 수신 호스트 
- 전송 오류가 없는 물리 매체
- 무한개의 수신 버퍼
- 흐름 제어 기능이 필요 없음
- 수신 호스트가 응답 플레임을 전송할 필요 없음
![[6장. 데이터 링크 계층-20240419130657022.webp|350]]
---
흐름 제어가 필요하지만 오류 제어는 필요 없는 전송 환경
- 단방향 통신: 송신 호스트 → 수신 호스트 
- 전송 오류가 없는 물리 매체
- 수신 버퍼의 개수가 유한함
- 흐름 제어 기능이 필요함: 프레임 분실 오류
- ACK 프레임: 다음 프레임을 전송하라고 지시함
- 분실 오류의 위험이 없기 때문에 순서 번호를 사용하지 않음
- 정지 · 대기 방식: 전송 효율이 떨어져서 사용하지 않음
![[6장. 데이터 링크 계층-20240419130910476.webp|350]]
---
흐름 제어와 오류 제어가 필요한 전송 환경
- 단방향 통신: 송신 호스트 → 수신 호스트
- 전송 오류가 있는 물리 매체
- 수신 버퍼의 개수가 유한
- 프레임 분실: 수신 호스트에 정보 프레임이 도착하길 무한정 기다림
- 프레임 분실 오류 대응: 타임아웃 기능이 필요함. 재전송 방식으로 복구함
- 프레임 변형 오류: NAK 프레임 전송. 재전송 방식으로 복구함
---
NAK 이 없는 경우
- I 프레임 분실/변형: 송신 호스트의 타임아웃 기능을 통해 I 프레임 재전송
![[6장. 데이터 링크 계층-20240419131126899.webp]]
![[6장. 데이터 링크 계층-20240419131138802.webp|260]]

---
NAK이 있는 경우
- I 프레임 변형: 변형 프레임 무시(분실 오류와 동일하게 처리), NAK 프레임을 이용해 재전송을 요구함
- I 프레임 분실: 송신 호스트와 타임아웃 기능을 통해 I 프레임을 재전송함
![[6장. 데이터 링크 계층-20240419131246402.webp]]
---
### 슬라이딩 윈도우 프로토콜
두 호스트 간의 프레임 전송을 위한 일반적인 통신 프로토콜
- 오류 제어 지원
- 흐름 제어 지원
##### 흐름 제어
순서 번호
- 0 ~ 임의의 최댓값을 순호나하는 방식으로 할당함
- 순서 번호 부여 원칙: 순서 번호의 최대값 > 송신 윈도우의 크기
- 부여 원칙을 지키지 않으면, 서로 다른 프레임에 같은 순서 번호가 할당됨
- 순서 번호를 위한 공간: n 비트 / 순서 번호의 범위:  0 ~ 2<sup>n</sup> - 1
- 정지 · 대기 방식의 프로토콜의 순서 번호의 범위:  **0, 1 (n = 1) // 윈도우 크기가 1**
---
윈도우 크기
- 송신 윈도우에 보관된 프레임: 수신 호스트에 전송되었으나 아직 ACK 프레임을 받지 못한 프레임
- 윈도우에 포함되는 정보 프레임의 관리 : 순서 번호의 묶음
- 송신 호스트에서 ACK 프레임을 회신 받으면 송신 윈도우의 순서 번호가 높은 번호로 순차적으로 이동
---
윈도우 크기 3의 슬라이딩 윈도우 프로토콜 동작 원리
![[6장. 데이터 링크 계층-20240419131812800.webp|300]]

---
### 연속형 전송
윈도우 크기를 늘려서 ACK 프레임을 받지 않고 여러 정보 프레임을 연속적으로 전송하는 방식
- 전송 오류 발생이 적은 환경에서 효율적임
연속형 전송 방식의 오류를 해결하는 방법
- Go-Back-N 방식
- 선택적 재전송 방식
---
##### Go-Back-N 방식
12번 I 프레임 이후로 전송된 모든 정보 프레임을 재전송하는 방식

---
##### Go-Back-N 방식과 선택적 재전송 방식 차이
Go-Back-N 방식에서는 앞선 순서 번호 (12번)를 갖는 I 프레임이 재전송될 때까지 다음 정보 프레임 (13 ~ 17번)을 모두 버리는 방식임

수신 윈도우는 현재 처리 중인 프레임 1개만 존재
- 수신 윈도우 크기 = 1
- **수신 윈도우의 크기 ≠ 송신 윈도우의 크기**

오류 없이 수신된 모든 정보 프레임을 수신 윈도우에서 모두 보관
- **수신 윈도우의 크기 = 송신 윈도우의 크기**
- 프레임의 도착 순서가 송신 순서와 일치하지 않을 수 있음
---
##### 피기배깅
ACK 프레임을 수용하도록 구조를 변경한 I 프레임을 사용하여 응답 기능까지 함께 수행하는 정보 프레임을 전송하는 방식
- 응답 프레임을 전송할 시점에 전송할 정보 프레임이 있으면
	- 피기배깅 기능을 사용할 수 있음
- 응답 프레임을 전송할 시점에 전송할 정보 프레임이 없으면
	- 잠시 후 전송할 프레임이 생기면 피기배깅 기능을 이용해서 같이 전송
	- 얼마나 기다리는지에 따라 시스템 성능에 영향을 줄 수 있음
---
#### HDLC<sup>High-level Data Link Control</sup>
고속 데이터 전송에 적합한 비트 지향형 프로토콜

HDLC 스테이션
- 주국 : 링크 제어의 책임을 갖고 명령을 내림
- 종국 : 주극의 제어 하에 단지 응답만 함
- 혼합국 : 명령/응답 둘 다 할 수 있음

프레임 구조
- Address(주소) : 1 : n 환경에서는 특정 호스트 주소, 주/종국 환경에서는 종국 주소
- Control(제어) : 제어 코드를 포함함
- Data(데이터) : 가변 크기의 데이터(캡슐화)
- Checksum(체크섬) : CRC-CCITT 생성 다항식 사용

Control 필드에 따라
- 정보 프레임
- 감독 프레임
- 비번호 프레임
---
##### 정보 프레임 (I 프레임)
Seq : I 프레임의 송신용 순서 번호(비트 수: 3, 0 ~ 7번)

Next : 피기배깅의 응답 기능으로 사용(이전 번호까지 프레임은 모두 오류 없이 수신됨), 다음에 수신을 기대하는 프레임 번호

P/F (1로 지정되었을 때 의미를 갖음) : Poll(주국의 명령 프레임에서 사용할 때 / 주국에서 데이터를 보내고자 하는 종국이 있는지 확인할 때), Final (종국의 응답 프레임에서 사용할 때 / 종국에서 주국으로 데이터를 전송할 때)
##### 감독 프레임(S 프레임)
I 프레임에 대한 응답 기능을 수행하는 프레임
- Type 0 (00): 긍정 응답 프레임, 다음에 수신을 기대하는 프레임 번호를 **Next**에 표시
- Type 1 (01): 부정 응답 프레임, 재전송되어야 하는 프레임의 번호를 **Nex**t에 표시
- Type 2 (10): 긍정 응답 프레임 + 흐름 제어 기능, **Next**에 표시한 순서 번호 이전까지는 정상 수신 완료했지만, 순서 번호 이후부터는 송신 호스트에 송신을 중지하도록 요청, 재전송 요구 시 다른 Type으로 요청
- Type 3 (11): 선택적 재전송 방식에서 부정 응답 기능, 특정 프레임에 대해 재전송할 시 번호를 **Next**에 표시
---
##### 비번호 프레임 (U 프레임)
연결제어 / 비연결형 데이터 전송, Type(2비트) + Modifier(3비트)
![[6장. 데이터 링크 계층-20240419133222682.webp]]
- SNRM<sup>Set NRM</sup>: 정규 응답 모드의 연결 설정을 수행
- SABM<sup>Set ABM</sup>: 비동기 균형 모드의 연결 설정을 수행
- SARM<sup>Set ARM</sup>: 비동기 응답 모드의 연결 설정을 수행
- DISC<sup>DISConnect</sup>: 연결 설정 해제를 수행
- RSET<sup>ReSET</sup>: 리셋을 수행
- FRMR<sup>FRaMe Reject</sup>: 프레임의 수신을 거부함
- UA<sup>Unnumbered ACK</sup>: U 프레임의 긍정 응답 기능을 수행
---
##### LAP<sup>Link Access Protocol</sup> 프로토콜
비동기 응답 모드(ARM)로 동작하는 프로토콜

---
##### LAP-B<sup>Link Access Protocol-Balanced</sup> 프로토콜
양쪽 호스트(혼합국)에서 비동기 균형모드 (ABM)로 동작하는 프로토콜